# ğŸš€ RaÃ­z Financiera - ChatBot Bancario

> Plataforma bancaria web con asistente virtual, contratos digitales y panel de administraciÃ³n. Â¡Moderna, segura y lista para producciÃ³n!

---

## âœ¨ CaracterÃ­sticas principales

- ğŸ¤– **Chatbot inteligente:** Responde consultas sobre productos financieros, requisitos y procesos.
- ğŸ” **Registro e inicio de sesiÃ³n:** AutenticaciÃ³n segura con JWT y cookies.
- ğŸ‘¤ **GestiÃ³n de usuarios:** Registro, login, perfiles y cierre de sesiÃ³n.
- ğŸ“„ **Contratos digitales:** GeneraciÃ³n y visualizaciÃ³n de contratos PDF con firma digital simulada.
- ğŸ’³ **Productos financieros:** Solicitud y gestiÃ³n de prÃ©stamos, tarjetas y seguros.
- ğŸ›¡ï¸ **Panel de administraciÃ³n:** Acceso exclusivo para admins mediante URL oculta.
- ğŸ“± **Frontend responsivo:** Interfaz moderna y adaptable a mÃ³viles y escritorio.
- ğŸ›¡ï¸ **Seguridad:** Rate limiting, sanitizaciÃ³n y validaciÃ³n de datos.
- ğŸ§ª **Pruebas automÃ¡ticas:** Tests de rutas y roles con reporte PDF.
- ğŸ³ **Despliegue fÃ¡cil:** Docker y Docker Compose listos para cualquier entorno.

---

## ğŸ“ Estructura del proyecto

```text
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app.js                  # Punto de entrada principal
â”‚   â”œâ”€â”€ config/                 # ConfiguraciÃ³n de servidor, base de datos y variables de entorno
â”‚   â”œâ”€â”€ domain/                 # Modelos de datos (Usuarios, Contratos, PrÃ©stamos, etc.)
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ controllers/        # LÃ³gica de negocio y generaciÃ³n de documentos
â”‚   â”‚   â””â”€â”€ services/           # Servicios de negocio
â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â”œâ”€â”€ routes/             # DefiniciÃ³n de rutas Express
â”‚   â”‚   â””â”€â”€ views/              # Vistas EJS (login, registro, index, PDF, errores)
â”‚   â””â”€â”€ shared/
â”‚       â”œâ”€â”€ errors/             # Manejo de errores personalizados
â”‚       â”œâ”€â”€ middleware/         # Middlewares de autenticaciÃ³n y seguridad
â”‚       â””â”€â”€ utils/              # Utilidades y mensajes del chatbot
â”œâ”€â”€ public/                     # EstÃ¡ticos: CSS, JS, imÃ¡genes, PDFs
â”œâ”€â”€ test/                       # Pruebas automÃ¡ticas
â”œâ”€â”€ .github/                    # Workflows y scripts de CI
â”œâ”€â”€ package.json
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ .env
â””â”€â”€ README.md
```

---

## âš¡ InstalaciÃ³n y ejecuciÃ³n local

1. **Clona el repositorio:**
   ```sh
   git clone <URL-del-repo>
   cd Proyecto_ChatBot
   ```
2. **Instala las dependencias:**
   ```sh
   npm install
   ```
3. **Configura el archivo `.env`:**
   ```env
   PUERTO=1010
   JWT_SECRET=tu_clave_secreta
   WIT_TOKEN=tu_token_de_wit_ai
   MONGO_URI=mongodb://localhost:27017/raizfinanciera
   ```
4. **Inicia MongoDB** (si no estÃ¡ corriendo).
5. **Ejecuta el servidor:**
   - En desarrollo:
     ```sh
     npm run dev
     ```
   - En producciÃ³n:
     ```sh
     npm start
     ```
6. **Abre:** [http://localhost:1010](http://localhost:1010)

---

## ğŸ³ EjecuciÃ³n con Docker y Docker Compose

1. **AsegÃºrate de tener Docker y Docker Compose instalados.**
2. **Configura tu `.env`** (usa `MONGO_URI=mongodb://mongo:27017/raizfinanciera`).
3. **Levanta la app y la base de datos:**
   ```sh
   docker compose up --build
   ```
4. **Abre:** [http://localhost:1010](http://localhost:1010)
5. **DetÃ©n los servicios:**
   ```sh
   docker compose down
   ```
> El archivo `docker-compose.yml` ya incluye MongoDB. Â¡No necesitas instalarlo localmente!

---

## ğŸ§ª Pruebas automÃ¡ticas

- Las pruebas estÃ¡n en `test/app.test.mjs`.
- Ejecuta:
  ```sh
  npx mocha test/app.test.mjs
  ```
- Se validan rutas pÃºblicas, protegidas por rol y de error.

---

## ğŸ“Š Reporte PDF de tests (CI/CD)

- Workflow en `.github/workflows/generate-pdf-report.yml`.
- Al hacer push a `main`:
  1. Se ejecutan los tests.
  2. Se genera un PDF con el resumen y detalle usando Puppeteer.
  3. El PDF queda como artefacto descargable en GitHub Actions.

---

## ğŸ”Œ Pruebas de la API con Postman

1. Descarga [`RaizFinanciera.postman_collection.json`](RaizFinanciera.postman_collection.json).
2. Importa en Postman.
3. Modifica los datos de ejemplo segÃºn tus pruebas.
4. Si algÃºn endpoint requiere token, haz login y usa el token en las variables de entorno de Postman.

---

## ğŸ›¡ï¸ Seguridad

- Acceso a rutas administrativas solo mediante URL oculta.
- Validaciones, sanitizaciÃ³n y manejo de errores personalizados.
- JWT y cookies seguras para autenticaciÃ³n y autorizaciÃ³n.

---

## ğŸ“š DocumentaciÃ³n Swagger

- [http://localhost:1010/api-docs/](http://localhost:1010/api-docs/)

---

## ğŸ‘¨â€ğŸ’» CrÃ©ditos

Desarrollado por **Grupo 2 - Universidad Mayor**.

---

> **Nota:** Este proyecto es solo para fines educativos y de demostraciÃ³n. No utilizar en producciÃ³n sin una revisiÃ³n exhaustiva de seguridad.